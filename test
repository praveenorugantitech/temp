 public static Transformer buildTransformer() throws TransformerConfigurationException {
        TransformerFactory transformerFactory = TransformerFactory.newInstance();

        // Secure TransformerFactory: Disable access to external DTDs and entities
        transformerFactory.setAttribute("http://javax.xml.XMLConstants/property/accessExternalDTD", "");
        transformerFactory.setAttribute("http://javax.xml.XMLConstants/property/accessExternalStylesheet", "");

        Transformer transformer = transformerFactory.newTransformer();

        // Configure transformer to omit XML declaration (since we wrote it manually)
        transformer.setOutputProperty("omit-xml-declaration", "yes");

        transformer.setOutputProperty(OutputKeys.INDENT, "yes"); // Enable indentation
        transformer.setOutputProperty(OutputKeys.METHOD, "xml"); // Ensure XML output

        return transformer;
    }
